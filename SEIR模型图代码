#SEIR模型# 定义微分方程seir<-function(time, state, pars){   with(as.list(c(state, pars)),{     dS <-- S * beta * I/N     dE <- S * beta * I/N - E * k     dI <- E * k - I * (mu + gamma)     dR <- I * gamma    dN <- dS + dE + dI + dR         list(c(dS,dE,dI,dR,dN))   }) } N <- 1.9E8 # 总人口I0 <- 89 # 期初感染数E0 <- 0 # 期初潜伏数RM0 <- 0 # 期初移除数S0 = N - I0 - RM0 # 期初易感人数init<-c(S = S0, E = E0, I = I0, R = RM0, N = N)	time <- seq(0, 150, 1) pars<-c(   beta = 0.55,	#有效接触率  k = 1,	#潜伏到感染的转化率   gamma = 0.2,	#RECOVERY   mu=0.02	#感染期死亡率 ) #载入desolve包和ggplot2包library(deSolve)library(ggplot2)res.seir<-as.data.frame(lsoda(y = init, times = time, func = seir, parms = pars)) ggplot(res.seir) +  geom_line(aes(x = time, y = S, col = 'R'))+  geom_line(aes(x = time, y = E, col = 'S'))+  geom_line(aes(x = time, y = I, col = 'N'))+  geom_line(aes(x = time, y = R, col = 'E'))+  geom_line(aes(x = time, y = N, col = 'I'))+  theme_light(base_family = 'Kai') +  scale_colour_manual("",                      values=c(                        "R" = "green", "S" = "orange",                        "N" = "black", "E" = "purple",                         "I" = "red"                      )  ) +  scale_y_continuous('')
